window.RTCPeerConnection=window.webkitRTCPeerConnection||window.mozRTCPeerConnection,window.RTCSessionDescription=window.mozRTCSessionDescription||window.RTCSessionDescription,window.URL=window.URL||window.webkitURL,navigator.getUserMedia=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;var Hello=function(){var a=io.connect(),b=new RTCPeerConnection({iceServers:[{url:"stun:stun.l.google.com:19302"}]},{optional:[{RtpDataChannels:!0}]}),c=function(c){b.setLocalDescription(c),a.emit("answer",c)};return b.onaddstream=function(a){URL.createObjectURL(a.stream)},b.onicecandidate=function(b){a.emit("ice",b.candidate)},a.on("offer",function(a){b.setRemoteDescription(new RTCSessionDescription(a)),b.createAnswer(c)}),a.on("answer",function(a){b.setRemoteDescription(new RTCSessionDescription(a))}),a.on("ice",function(){}),{socket:a,stream:null}};Hello.prototype.register=function(a){this.socket.emit("register",a)},Hello.prototype.call=function(a){var b={audio:!0,video:!0},c=function(b){this.stream=b,this.socket.emit("call",a)}.bind(this),d=function(){console.error(arguments)};navigator.getUserMedia(b,c,d)};